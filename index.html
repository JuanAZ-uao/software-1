<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Universidad ¬∑ Demo sin React</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { color-scheme: light dark; }
    /* Elimina estilos duplicados y usa Tailwind en el HTML */
    /* Mant√©n solo lo necesario para el toaster y animaciones */
    #toaster { position: fixed; right: 1rem; bottom: 1rem; display: grid; gap: .5rem; z-index: 50; }
    .toast {
      background-color: #fff;
      border-radius: 1rem;
      box-shadow: 0 1px 2px rgba(0,0,0,.06), 0 1px 3px rgba(0,0,0,.1);
      padding: 0.75rem 1rem;
      border: 1px solid #e5e5e5;
      animation: toast-in .2s ease-out;
    }
    .dark .toast {
      background-color: #171717;
      border-color: #262626;
    }
    @keyframes toast-in { from { opacity: 0; transform: translateY(6px)} to { opacity: 1; transform: translateY(0)} }
    .view { opacity: 0; transform: translateY(8px); pointer-events:none; position: absolute; inset: 0; transition: opacity .25s, transform .25s; }
    .view.active { opacity: 1; transform: translateY(0); pointer-events:auto; position: relative; }
  </style>
</head>
<body class="min-h-full bg-neutral-50 dark:bg-neutral-950 text-neutral-900 dark:text-neutral-100">
  <div id="app" class="min-h-screen">

    <!-- Header -->
    <header class="sticky top-0 z-40 border-b border-neutral-200/70 dark:border-neutral-800/70 backdrop-blur bg-white/70 dark:bg-neutral-950/70">
      <div class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 rounded-xl bg-blue-600"></div>
          <span class="font-semibold">Plataforma Universitaria</span>
        </div>
        <nav id="nav" class="hidden md:flex items-center gap-2">
          <button class="btn px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition" data-nav="dashboard">Dashboard</button>
          <button class="btn px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition" data-nav="profile">Perfil</button>
          <button class="btn px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition" data-nav="organizations">Organizaciones</button>
          <button class="btn px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition" data-nav="events">Eventos</button>
          <button class="btn px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition" data-nav="users">Usuarios</button>
          <button class="btn px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition" data-nav="calendar">Calendario</button>
          <button class="btn px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition" data-nav="notifications">Notificaciones</button>
          <button class="btn px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition" data-nav="settings">Configuraci√≥n</button>
        </nav>
        <div class="flex items-center gap-2">
          <button id="themeBtn" class="btn px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition" title="Alternar tema">üåó</button>
          <button id="authBtn" class="btn px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition">Iniciar sesi√≥n</button>
        </div>
      </div>
    </header>

    <!-- Main -->
    <main class="min-h-[calc(100vh-4rem)]">
      <div class="max-w-6xl mx-auto px-4 py-6 relative">

        <!-- Auth Screen -->
        <section id="view-auth" class="view active">
          <div class="max-w-md mx-auto card">
            <h1 class="title mb-2">Autenticaci√≥n</h1>
            <p class="muted mb-6">Inicia sesi√≥n para continuar</p>
            <form id="loginForm" class="grid gap-4">
              <div>
                <label class="block text-sm mb-1">Nombre</label>
                <input id="name" class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2" placeholder="Tu nombre" required />
              </div>
              <div>
                <label class="block text-sm mb-1">Email</label>
                <input id="email" type="email" class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2" placeholder="tucorreo@uao.edu.co" required />
              </div>
              <div>
                <label class="block text-sm mb-1">Rol</label>
                <select id="role" class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2">
                  <option>Estudiante</option>
                  <option>Profesor</option>
                  <option>Administrador</option>
                </select>
              </div>
              <button class="btn" type="submit">Entrar</button>
            </form>
          </div>
        </section>

        <!-- Dashboard -->
        <section id="view-dashboard" class="view">
          <div class="mb-6">
            <button class="link" data-nav="dashboard">‚Üê Dashboard</button>
            <h1 class="title mt-2">Dashboard</h1>
            <p class="muted">Resumen general y accesos r√°pidos.</p>
          </div>
          <div class="grid md:grid-cols-3 gap-4">
            <div class="card">
              <h2 class="font-medium mb-2">Perfil</h2>
              <p class="muted mb-4">Actualiza tu informaci√≥n personal.</p>
              <button class="btn" data-nav="profile">Ir al Perfil</button>
            </div>
            <div class="card">
              <h2 class="font-medium mb-2">Organizaciones</h2>
              <p class="muted mb-4">Gestiona organizaciones externas.</p>
              <button class="btn" data-nav="organizations">Abrir</button>
            </div>
            <div class="card">
              <h2 class="font-medium mb-2">Eventos</h2>
              <p class="muted mb-4">Crea y administra eventos.</p>
              <button class="btn" data-nav="events">Abrir</button>
            </div>
          </div>
        </section>

        <!-- Perfil -->
        <section id="view-profile" class="view">
          <div class="mb-6">
            <button class="link" data-nav="dashboard">‚Üê Volver al Dashboard</button>
            <h1 class="title mt-2">Editar Perfil</h1>
            <p class="muted">Actualiza tus datos b√°sicos.</p>
          </div>
          <div class="card grid gap-4 max-w-2xl">
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm mb-1">Nombre</label>
                <input id="p_name" class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2" />
              </div>
              <div>
                <label class="block text-sm mb-1">Departamento</label>
                <input id="p_dept" class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2" />
              </div>
            </div>
            <div class="grid md:grid-cols-3 gap-4">
              <div>
                <label class="block text-sm mb-1">Modo oscuro</label>
                <select id="p_dark" class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2">
                  <option value="false">Claro</option>
                  <option value="true">Oscuro</option>
                </select>
              </div>
              <div>
                <label class="block text-sm mb-1">Email notif.</label>
                <select id="p_emailn" class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2">
                  <option value="true">S√≠</option>
                  <option value="false">No</option>
                </select>
              </div>
              <div>
                <label class="block text-sm mb-1">Perfil p√∫blico</label>
                <select id="p_public" class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2">
                  <option value="true">S√≠</option>
                  <option value="false">No</option>
                </select>
              </div>
            </div>
            <div class="flex gap-2">
              <button id="saveProfile" class="btn">Guardar</button>
              <button class="btn" data-nav="dashboard">Cancelar</button>
            </div>
          </div>
        </section>

        <!-- Organizaciones -->
        <section id="view-organizations" class="view">
          <div class="mb-6">
            <button class="link" data-nav="dashboard">‚Üê Volver al Dashboard</button>
            <h1 class="title mt-2">Gesti√≥n de Organizaciones Externas</h1>
            <p class="muted">Registra y administra las organizaciones colaboradoras con la universidad</p>
          </div>
          <div class="card">
            <div class="flex items-center gap-2 mb-4">
              <input id="org_name" placeholder="Nombre de la organizaci√≥n" class="flex-1 rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2"/>
              <button id="org_add" class="btn">A√±adir</button>
            </div>
            <ul id="org_list" class="space-y-2"></ul>
          </div>
        </section>

        <!-- Eventos -->
        <section id="view-events" class="view">
          <div class="mb-6">
            <button class="link" data-nav="dashboard">‚Üê Volver al Dashboard</button>
          </div>
          <div class="card">
            <h2 class="font-medium mb-2">Eventos</h2>
            <div class="grid md:grid-cols-3 gap-3">
              <input id="ev_title" placeholder="T√≠tulo" class="rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2"/>
              <input id="ev_date" type="date" class="rounded-xl border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2"/>
              <button id="ev_add" class="btn">Crear</button>
            </div>
            <ul id="ev_list" class="mt-4 space-y-2"></ul>
          </div>
        </section>

        <!-- Usuarios (solo Admin) -->
        <section id="view-users" class="view">
          <div class="mb-6">
            <button class="link" data-nav="dashboard">‚Üê Volver al Dashboard</button>
            <h1 class="title mt-2">Gesti√≥n de Usuarios</h1>
            <p class="muted">Administra los usuarios del sistema universitario</p>
          </div>
          <div class="card">
            <p class="muted">(Demo) Solo visible si tu rol es <b>Administrador</b>.</p>
            <ul id="user_list" class="mt-3 space-y-1"></ul>
          </div>
        </section>

        <!-- Calendario -->
        <section id="view-calendar" class="view">
          <div class="mb-6">
            <button class="link" data-nav="dashboard">‚Üê Volver al Dashboard</button>
            <h1 class="title mt-2">Calendario de Eventos</h1>
            <p class="muted">Vista mensual de todos los eventos universitarios</p>
          </div>
          <div class="card">
            <div id="calendar" class="grid grid-cols-7 gap-2 text-center"></div>
          </div>
        </section>

        <!-- Notificaciones -->
        <section id="view-notifications" class="view">
          <div class="mb-6">
            <button class="link" data-nav="dashboard">‚Üê Volver al Dashboard</button>
            <h1 class="title mt-2">Notificaciones</h1>
            <p class="muted">Mantente al d√≠a con todas las actualizaciones</p>
          </div>
          <div class="card">
            <ul id="notif_list" class="space-y-2"></ul>
          </div>
        </section>

        <!-- Configuraci√≥n -->
        <section id="view-settings" class="view">
          <div class="mb-6">
            <button class="link" data-nav="dashboard">‚Üê Volver al Dashboard</button>
            <h1 class="title mt-2">Configuraci√≥n</h1>
            <p class="muted">Personaliza tu experiencia en la plataforma</p>
          </div>
          <div class="card max-w-xl grid gap-4">
            <div class="flex items-center justify-between">
              <div>
                <div class="font-medium">Tema</div>
                <div class="muted text-sm">Alternar modo oscuro</div>
              </div>
              <button id="settingsTheme" class="btn">Alternar</button>
            </div>
          </div>
        </section>

      </div>
    </main>
  </div>

  <div id="toaster"></div>

  <script>
    // ----- Estado global (simplificado) -----
    const state = {
      currentUser: null,
      currentView: 'auth',
      notifications: [],
      darkMode: false,
      orgs: [],
      events: [],
      users: [{name:'Admin Ejemplo', role:'Administrador'},{name:'Profe Ana', role:'Profesor'}],
    };

    // Load theme pref
    (function initTheme(){
      const saved = localStorage.getItem('darkMode') === 'true';
      state.darkMode = saved;
      document.documentElement.classList.toggle('dark', saved);
    })();

    const d = (sel, ctx=document) => ctx.querySelector(sel);
    const da = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

    // Router
    function go(view){
      state.currentView = view;
      da('.view').forEach(v=>v.classList.remove('active'));
      const el = d(`#view-${view}`);
      if(el) el.classList.add('active');
      // Nav visibility and auth button
      const nav = d('#nav');
      const authBtn = d('#authBtn');
      if(state.currentUser){
        nav.classList.remove('hidden');
        authBtn.textContent = 'Cerrar sesi√≥n';
      } else {
        nav.classList.add('hidden');
        authBtn.textContent = 'Iniciar sesi√≥n';
      }
      // Users gate
      const usersViewBtn = da('[data-nav="users"]');
      usersViewBtn.forEach(b=>{
        b.disabled = !state.currentUser || state.currentUser.role !== 'Administrador';
        b.classList.toggle('opacity-50', b.disabled);
      });
      render();
    }

    // Toaster
    function toast(title, description){
      const wrap = d('#toaster');
      const item = document.createElement('div');
      item.className = 'toast';
      item.innerHTML = `<div class="font-medium">${title}</div>${description?`<div class="muted text-sm">${description}</div>`:''}`;
      wrap.appendChild(item);
      setTimeout(()=>{ item.style.opacity=0; item.style.transform='translateY(6px)'; setTimeout(()=>item.remove(),200); }, 2800);
    }

    // Notifications helpers
    function addNotification(partial){
      const notif = {
        id: Date.now().toString(),
        type: partial.type||'system',
        title: partial.title||'Notificaci√≥n',
        message: partial.message||'',
        date: new Date(),
        read: !!partial.read,
        actionUrl: partial.actionUrl
      };
      state.notifications = [notif, ...state.notifications];
      toast(notif.title, notif.message);
      renderNotifications();
    }

    function markNotificationAsRead(id){
      state.notifications = state.notifications.map(n=> n.id===id? {...n, read:true }: n);
      renderNotifications();
    }

    // Renderers
    function renderNotifications(){
      const ul = d('#notif_list');
      if(!ul) return;
      ul.innerHTML = '';
      state.notifications.forEach(n=>{
        const li = document.createElement('li');
        li.className = 'border border-neutral-200 dark:border-neutral-800 rounded-xl p-3 flex items-start gap-3';
        li.innerHTML = `
          <div class="mt-1">${n.type==='event'?'üìÖ':'üîî'}</div>
          <div class="flex-1">
            <div class="flex items-center justify-between gap-2">
              <div class="font-medium">${n.title}</div>
              <div class="text-xs muted">${n.date.toLocaleString()}</div>
            </div>
            <div class="text-sm">${n.message}</div>
            <div class="mt-2">
              <button class="btn text-sm" data-read="${n.id}" ${n.read?'disabled':''}>Marcar como le√≠da</button>
            </div>
          </div>`;
        ul.appendChild(li);
      });
      da('[data-read]').forEach(b=> b.onclick = ()=> markNotificationAsRead(b.getAttribute('data-read')));
    }

    function renderUsers(){
      const ul = d('#user_list');
      if(!ul) return;
      ul.innerHTML = state.users.map(u=>`<li class="border border-neutral-200 dark:border-neutral-800 rounded-xl p-2">${u.name} ‚Äî <span class="muted">${u.role}</span></li>`).join('');
    }

    function renderOrgs(){
      const ul = d('#org_list');
      if(!ul) return;
      ul.innerHTML = state.orgs.map((o,i)=>`<li class="border border-neutral-200 dark:border-neutral-800 rounded-xl p-2 flex items-center justify-between"><span>${o}</span><button class="btn text-xs" data-delorg="${i}">Eliminar</button></li>`).join('');
      da('[data-delorg]').forEach(b=> b.onclick = ()=>{ state.orgs.splice(+b.getAttribute('data-delorg'),1); renderOrgs(); });
    }

    function renderEvents(){
      const ul = d('#ev_list');
      if(!ul) return;
      ul.innerHTML = state.events.map((e,i)=>`<li class="border border-neutral-200 dark:border-neutral-800 rounded-xl p-2 flex items-center justify-between"><span>${e.title} ‚Äî <span class="muted">${e.date}</span></span><button class="btn text-xs" data-delev="${i}">Eliminar</button></li>`).join('');
      da('[data-delev]').forEach(b=> b.onclick = ()=>{ state.events.splice(+b.getAttribute('data-delev'),1); renderEvents(); });
    }

    function renderCalendar(){
      const grid = d('#calendar');
      if(!grid) return;
      const now = new Date();
      const year = now.getFullYear();
      const month = now.getMonth();
      const first = new Date(year, month, 1);
      const startDay = first.getDay();
      const daysInMonth = new Date(year, month+1, 0).getDate();
      grid.innerHTML = '';
      // headers
      ['Dom','Lun','Mar','Mi√©','Jue','Vie','S√°b'].forEach(h=>{
        const c = document.createElement('div'); c.className = 'text-xs muted'; c.textContent = h; grid.appendChild(c);
      });
      for(let i=0;i<startDay;i++){ grid.appendChild(document.createElement('div')); }
      for(let dnum=1; dnum<=daysInMonth; dnum++){
        const c = document.createElement('div');
        c.className = 'border border-neutral-200 dark:border-neutral-800 rounded-xl p-2 min-h-[60px] text-left';
        c.innerHTML = `<div class="text-sm font-medium">${dnum}</div>`;
        const dateStr = new Date(year, month, dnum).toISOString().slice(0,10);
        const evs = state.events.filter(e=>e.date===dateStr);
        evs.forEach(e=>{
          const tag = document.createElement('div');
          tag.className = 'mt-1 text-xs rounded-lg px-2 py-1 bg-blue-100 dark:bg-blue-900/50';
          tag.textContent = e.title;
          c.appendChild(tag);
        });
        grid.appendChild(c);
      }
    }

    function renderProfileForm(){
      if(!state.currentUser) return;
      d('#p_name').value = state.currentUser.name || '';
      d('#p_dept').value = state.currentUser.department || '';
      d('#p_dark').value = String(state.darkMode);
      d('#p_emailn').value = 'true';
      d('#p_public').value = 'true';
    }

    function render(){
      renderNotifications();
      renderUsers();
      renderOrgs();
      renderEvents();
      renderCalendar();
      if(state.currentView==='profile') renderProfileForm();
    }

    // --- Event bindings ---
    // Nav buttons
    da('[data-nav]').forEach(btn=> btn.addEventListener('click', ()=>{
      const view = btn.getAttribute('data-nav');
      if(view==='dashboard' && !state.currentUser) return go('auth');
      if(view==='users' && (!state.currentUser || state.currentUser.role!=='Administrador')) return toast('Acceso denegado','Necesitas rol Administrador');
      go(view);
    }));

    // Theme buttons
    const themeToggle = ()=>{
      state.darkMode = !state.darkMode;
      document.documentElement.classList.toggle('dark', state.darkMode);
      localStorage.setItem('darkMode', String(state.darkMode));
    };
    d('#themeBtn').onclick = themeToggle;
    d('#settingsTheme').onclick = themeToggle;

    // Auth button (header)
    d('#authBtn').onclick = ()=>{
      if(state.currentUser){
        // logout
        state.currentUser = null;
        state.notifications = [];
        toast('Sesi√≥n cerrada correctamente');
        go('auth');
      } else {
        go('auth');
      }
    };

    // Login form
    d('#loginForm').onsubmit = (e)=>{
      e.preventDefault();
      const user = {
        id: String(Date.now()),
        name: d('#name').value.trim(),
        email: d('#email').value.trim(),
        role: d('#role').value,
        department: 'Ingenier√≠a',
        joinDate: new Date().toISOString().slice(0,10),
        preferences: { darkMode: state.darkMode, emailNotifications: true, publicProfile: true }
      };
      state.currentUser = user;
      addNotification({ type:'system', title:'¬°Bienvenido de vuelta!', message:`Has iniciado sesi√≥n como ${user.name} (${user.role})`, read:false });
      addNotification({ type:'event', title:'Eventos pr√≥ximos', message:'Tienes 3 eventos pr√≥ximos esta semana', read:false });
      go('dashboard');
    };

    // Profile save
    d('#saveProfile').onclick = ()=>{
      if(!state.currentUser) return;
      state.currentUser.name = d('#p_name').value.trim();
      state.currentUser.department = d('#p_dept').value.trim();
      const wantsDark = d('#p_dark').value === 'true';
      if(wantsDark !== state.darkMode){ themeToggle(); }
      addNotification({ type:'system', title:'Perfil actualizado', message:'Tus cambios fueron guardados', read:false });
      go('dashboard');
    };

    // Orgs
    d('#org_add').onclick = ()=>{
      const v = d('#org_name').value.trim();
      if(!v) return;
      state.orgs.push(v); d('#org_name').value=''; renderOrgs();
    };

    // Events
    d('#ev_add').onclick = ()=>{
      const t = d('#ev_title').value.trim();
      const dt = d('#ev_date').value;
      if(!t||!dt) return;
      state.events.push({ title:t, date:dt });
      d('#ev_title').value=''; d('#ev_date').value='';
      renderEvents(); renderCalendar();
      addNotification({ type:'event', title:'Evento creado', message:`${t} el ${dt}`, read:false });
    };

    // Init
    go('auth');
  </script>
</body>
</html>
